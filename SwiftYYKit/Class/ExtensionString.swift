//
//  ExtensionString.swift
//  SwiftYYKit
//
//  Created by ç‹æ–‡åš on 15/12/15.
//  Copyright Â© 2015å¹´ Double. All rights reserved.
//

import Foundation
import UIKit

extension String {
  
  subscript (i: Int) -> Character {
    return self[self.startIndex.advancedBy(i)]
  }
  
  subscript (i: Int) -> String {
    return String(self[i] as Character)
  }
  
  subscript (r: Range<Int>) -> String {
    return substringWithRange(Range(start: startIndex.advancedBy(r.startIndex), end: startIndex.advancedBy(r.endIndex)))
  }
  
  //MARK: - Utilities
  /// return String length
  var length:Int {
    return characters.count
  }
  
  /// return String MD5
  var MD5: String! {
    let str = self.cStringUsingEncoding(NSUTF8StringEncoding)
    let strLen = CC_LONG(self.lengthOfBytesUsingEncoding(NSUTF8StringEncoding))
    let digestLen = Int(CC_MD5_DIGEST_LENGTH)
    let result = UnsafeMutablePointer<CUnsignedChar>.alloc(digestLen)
    CC_MD5(str!, strLen, result)
    let hash = NSMutableString()
    for i in 0..<digestLen {
      hash.appendFormat("%02x", result[i])
    }
    result.dealloc(digestLen)
    return String(format: hash as String)
  }
  
  /**
  nil, @"", @"  ", @"\n" will Returns NO; otherwise Returns YES.
  */
  func isNotBlank() -> Bool {
    let blank:NSCharacterSet = NSCharacterSet.whitespaceAndNewlineCharacterSet()
    for var i = 0;i < self.characters.count; ++i {
      let c = (self as NSString).characterAtIndex(i)
      if !blank.characterIsMember(c) {
        return true
      }
    }
    return false
  }
  
  /**
  Create a string with the file in main bundle (similar to [UIImage imageNamed:]).
  
  @param name The file name (in main bundle).
  
  @return A new string create from the file in UTF-8.
  */
  func stringNamed(name:String) -> String? {
    let path = NSBundle.mainBundle().pathForResource(name, ofType: "")
    do {
      let content = try String(contentsOfFile:path!, encoding: NSUTF8StringEncoding)
      return content
    } catch _ as NSError {
      return nil
    }
  }
  
  /**
   Trim blank characters (space and newline) in head and tail.
   @return the trimmed string.
   */
  func stringByTrim() -> String {
    let set = NSCharacterSet.whitespaceAndNewlineCharacterSet()
    return self.stringByTrimmingCharactersInSet(set)
  }
  
  //MARK: - Drawing
  /**
  Returns the size of the string if it were rendered with the specified constraints.
  
  @param font          The font to use for computing the string size.
  
  @param size          The maximum acceptable size for the string. This value is
  used to calculate where line breaks and wrapping would occur.
  
  @return              The width and height of the resulting string's bounding box.
  These values may be rounded up to the nearest whole number.
  */
  func sizeForFont(font:UIFont, size:CGSize) -> CGSize {
    let fString = self as NSString
    let paragraphStyle = NSMutableParagraphStyle()
    paragraphStyle.lineBreakMode = NSLineBreakMode.ByWordWrapping
    let attrDict = [
      NSFontAttributeName: font,
      NSParagraphStyleAttributeName: paragraphStyle
    ]
    let rect = fString.boundingRectWithSize(size,
      options: [.TruncatesLastVisibleLine, .UsesLineFragmentOrigin],
      attributes: attrDict,
      context: nil)
    return rect.size
  }
  
  /**
   Returns the width of the string if it were to be rendered with the specified
   font on a single line.
   
   @param font  The font to use for computing the string width.
   
   @return      The width of the resulting string's bounding box. These values may be
   rounded up to the nearest whole number.
   */
  func widthForFont(font:UIFont) -> CGFloat {
    let size = self.sizeForFont(font, size:CGSize(width:CGFloat(MAXFLOAT), height:CGFloat(MAXFLOAT)))
    return size.width
  }
  
  /**
   Returns the height of the string if it were rendered with the specified constraints.
   
   @param font   The font to use for computing the string size.
   
   @param width  The maximum acceptable width for the string. This value is used
   to calculate where line breaks and wrapping would occur.
   
   @return       The height of the resulting string's bounding box. These values
   may be rounded up to the nearest whole number.
   */
  func heightForFont(font:UIFont, width:CGFloat) -> CGFloat {
    let size = self.sizeForFont(font, size: CGSize(width: width, height: CGFloat(MAXFLOAT)))
    return size.height
  }
  
  //MARK: - Emoji
  /**
   Returns all Apple Emoji combines in a string.
   */
  static func allEmoji() -> String {
    struct Static {
      static var str:String = ""
      static var onceToken:dispatch_once_t = 0
    }
    dispatch_once(&Static.onceToken) {
      let keys = ["people", "nature", "object", "places", "symbols"]
      for key in keys {
        Static.str = Static.str + String.allEmojiByGroup(key)
      }
    }
    return Static.str
  }
  
  /**
   Returns grouped Apple Emoji combines in a string.
   
   @param group Emoji group, support value: @"people" @"nature" @"object" @"places" @"symbols"
   */
  static func allEmojiByGroup(group:String) -> String {
    struct Static {
      static var dic:Dictionary = ["":""]
      static var onceToken:dispatch_once_t = 0
    }
    dispatch_once(&Static.onceToken) {
      Static.dic = [
        "people" : "ğŸ˜„ğŸ˜ƒğŸ˜€ğŸ˜Šâ˜ºï¸ğŸ˜‰ğŸ˜ğŸ˜˜ğŸ˜šğŸ˜—ğŸ˜™ğŸ˜œğŸ˜ğŸ˜›ğŸ˜³ğŸ˜ğŸ˜”ğŸ˜ŒğŸ˜’ğŸ˜ğŸ˜£ğŸ˜¢ğŸ˜‚ğŸ˜­ğŸ˜ªğŸ˜¥ğŸ˜°ğŸ˜…ğŸ˜“ğŸ˜©ğŸ˜«ğŸ˜¨ğŸ˜±ğŸ˜ ğŸ˜¡ğŸ˜¤ğŸ˜–ğŸ˜†ğŸ˜‹ğŸ˜·ğŸ˜ğŸ˜´ğŸ˜µğŸ˜²ğŸ˜ŸğŸ˜¦ğŸ˜§ğŸ˜ˆğŸ‘¿ğŸ˜®ğŸ˜¬ğŸ˜ğŸ˜•ğŸ˜¯ğŸ˜¶ğŸ˜‡ğŸ˜ğŸ˜‘ğŸ‘²ğŸ‘³ğŸ‘®ğŸ‘·ğŸ’‚ğŸ‘¶ğŸ‘¦ğŸ‘§ğŸ‘¨ğŸ‘©ğŸ‘´ğŸ‘µğŸ‘±ğŸ‘¼ğŸ‘¸ğŸ˜ºğŸ˜¸ğŸ˜»ğŸ˜½ğŸ˜¼ğŸ™€ğŸ˜¿ğŸ˜¹ğŸ˜¾ğŸ‘¹ğŸ‘ºğŸ™ˆğŸ™‰ğŸ™ŠğŸ’€ğŸ‘½ğŸ’©ğŸ”¥âœ¨ğŸŒŸğŸ’«ğŸ’¥ğŸ’¢ğŸ’¦ğŸ’§ğŸ’¤ğŸ’¨ğŸ‘‚ğŸ‘€ğŸ‘ƒğŸ‘…ğŸ‘„ğŸ‘ğŸ‘ğŸ‘ŒğŸ‘ŠâœŠâœŒï¸ğŸ‘‹âœ‹ğŸ‘ğŸ‘†ğŸ‘‡ğŸ‘‰ğŸ‘ˆğŸ™ŒğŸ™â˜ï¸ğŸ‘ğŸ’ªğŸš¶ğŸƒğŸ’ƒğŸ‘«ğŸ‘ªğŸ‘¬ğŸ‘­ğŸ’ğŸ’‘ğŸ‘¯ğŸ™†ğŸ™…ğŸ’ğŸ™‹ğŸ’†ğŸ’‡ğŸ’…ğŸ‘°ğŸ™ğŸ™ğŸ™‡ğŸ©ğŸ‘‘ğŸ‘’ğŸ‘ŸğŸ‘ğŸ‘¡ğŸ‘ ğŸ‘¢ğŸ‘•ğŸ‘”ğŸ‘šğŸ‘—ğŸ½ğŸ‘–ğŸ‘˜ğŸ‘™ğŸ’¼ğŸ‘œğŸ‘ğŸ‘›ğŸ‘“ğŸ€ğŸŒ‚ğŸ’„ğŸ’›ğŸ’™ğŸ’œğŸ’šâ¤ï¸ğŸ’”ğŸ’—ğŸ’“ğŸ’•ğŸ’–ğŸ’ğŸ’˜ğŸ’ŒğŸ’‹ğŸ’ğŸ’ğŸ‘¤ğŸ‘¥ğŸ’¬ğŸ‘£ğŸ’­",
        "nature" : "ğŸ¶ğŸºğŸ±ğŸ­ğŸ¹ğŸ°ğŸ¸ğŸ¯ğŸ¨ğŸ»ğŸ·ğŸ½ğŸ®ğŸ—ğŸµğŸ’ğŸ´ğŸ‘ğŸ˜ğŸ¼ğŸ§ğŸ¦ğŸ¤ğŸ¥ğŸ£ğŸ”ğŸğŸ¢ğŸ›ğŸğŸœğŸğŸŒğŸ™ğŸšğŸ ğŸŸğŸ¬ğŸ³ğŸ‹ğŸ„ğŸğŸ€ğŸƒğŸ…ğŸ‡ğŸ‰ğŸğŸğŸ“ğŸ•ğŸ–ğŸğŸ‚ğŸ²ğŸ¡ğŸŠğŸ«ğŸªğŸ†ğŸˆğŸ©ğŸ¾ğŸ’ğŸŒ¸ğŸŒ·ğŸ€ğŸŒ¹ğŸŒ»ğŸŒºğŸğŸƒğŸ‚ğŸŒ¿ğŸŒ¾ğŸ„ğŸŒµğŸŒ´ğŸŒ²ğŸŒ³ğŸŒ°ğŸŒ±ğŸŒ¼ğŸŒğŸŒğŸŒğŸŒšğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜ğŸŒœğŸŒ›ğŸŒ™ğŸŒğŸŒğŸŒğŸŒ‹ğŸŒŒğŸŒ â­ï¸â˜€ï¸â›…ï¸â˜ï¸âš¡ï¸â˜”ï¸â„ï¸â›„ï¸ğŸŒ€ğŸŒğŸŒˆğŸŒŠ",
        "object" : "ğŸğŸ’ğŸğŸ’ğŸ“ğŸğŸ†ğŸ‡ğŸğŸ‘ğŸƒğŸ‘»ğŸ…ğŸ„ğŸğŸ‹ğŸ‰ğŸŠğŸˆğŸŒğŸ”®ğŸ¥ğŸ“·ğŸ“¹ğŸ“¼ğŸ’¿ğŸ“€ğŸ’½ğŸ’¾ğŸ’»ğŸ“±â˜ï¸ğŸ“ğŸ“ŸğŸ“ ğŸ“¡ğŸ“ºğŸ“»ğŸ”ŠğŸ”‰ğŸ”ˆğŸ”‡ğŸ””ğŸ”•ğŸ“¢ğŸ“£â³âŒ›ï¸â°âŒšï¸ğŸ”“ğŸ”’ğŸ”ğŸ”ğŸ”‘ğŸ”ğŸ’¡ğŸ”¦ğŸ”†ğŸ”…ğŸ”ŒğŸ”‹ğŸ”ğŸ›ğŸ›€ğŸš¿ğŸš½ğŸ”§ğŸ”©ğŸ”¨ğŸšªğŸš¬ğŸ’£ğŸ”«ğŸ”ªğŸ’ŠğŸ’‰ğŸ’°ğŸ’´ğŸ’µğŸ’·ğŸ’¶ğŸ’³ğŸ’¸ğŸ“²ğŸ“§ğŸ“¥ğŸ“¤âœ‰ï¸ğŸ“©ğŸ“¨ğŸ“¯ğŸ“«ğŸ“ªğŸ“¬ğŸ“­ğŸ“®ğŸ“¦ğŸ“ğŸ“„ğŸ“ƒğŸ“‘ğŸ“ŠğŸ“ˆğŸ“‰ğŸ“œğŸ“‹ğŸ“…ğŸ“†ğŸ“‡ğŸ“ğŸ“‚âœ‚ï¸ğŸ“ŒğŸ“âœ’ï¸âœï¸ğŸ“ğŸ“ğŸ“•ğŸ“—ğŸ“˜ğŸ“™ğŸ““ğŸ“”ğŸ“’ğŸ“šğŸ“–ğŸ”–ğŸ“›ğŸ”¬ğŸ”­ğŸ“°ğŸ¨ğŸ¬ğŸ¤ğŸ§ğŸ¼ğŸµğŸ¶ğŸ¹ğŸ»ğŸºğŸ·ğŸ¸ğŸ‘¾ğŸ®ğŸƒğŸ´ğŸ€„ï¸ğŸ²ğŸ¯ğŸˆğŸ€âš½ï¸âš¾ï¸ğŸ¾ğŸ±ğŸ‰ğŸ³â›³ï¸ğŸšµğŸš´ğŸğŸ‡ğŸ†ğŸ¿ğŸ‚ğŸŠğŸ„ğŸ£â˜•ï¸ğŸµğŸ¶ğŸ¼ğŸºğŸ»ğŸ¸ğŸ¹ğŸ·ğŸ´ğŸ•ğŸ”ğŸŸğŸ—ğŸ–ğŸğŸ›ğŸ¤ğŸ±ğŸ£ğŸ¥ğŸ™ğŸ˜ğŸšğŸœğŸ²ğŸ¢ğŸ¡ğŸ³ğŸğŸ©ğŸ®ğŸ¦ğŸ¨ğŸ§ğŸ‚ğŸ°ğŸªğŸ«ğŸ¬ğŸ­ğŸ¯ğŸğŸğŸŠğŸ‹ğŸ’ğŸ‡ğŸ‰ğŸ“ğŸ‘ğŸˆğŸŒğŸğŸğŸ ğŸ†ğŸ…ğŸŒ½",
        "places" : "ğŸ ğŸ¡ğŸ«ğŸ¢ğŸ£ğŸ¥ğŸ¦ğŸªğŸ©ğŸ¨ğŸ’’â›ªğŸ¬ğŸ¤ğŸŒ‡ğŸŒ†ğŸ¯ğŸ°â›ºğŸ­ğŸ—¼ğŸ—¾ğŸ—»ğŸŒ„ğŸŒ…ğŸŒƒğŸ—½ğŸŒ‰ğŸ ğŸ¡â›²ğŸ¢ğŸš¢â›µğŸš¤ğŸš£âš“ğŸš€âœˆğŸ’ºğŸšğŸš‚ğŸšŠğŸš‰ğŸšğŸš†ğŸš„ğŸš…ğŸšˆğŸš‡ğŸšğŸš‹ğŸšƒğŸšğŸšŒğŸšğŸš™ğŸš˜ğŸš—ğŸš•ğŸš–ğŸš›ğŸššğŸš¨ğŸš“ğŸš”ğŸš’ğŸš‘ğŸšğŸš²ğŸš¡ğŸšŸğŸš ğŸšœğŸ’ˆğŸšğŸ«ğŸš¦ğŸš¥âš ğŸš§ğŸ”°â›½ğŸ®ğŸ°â™¨ğŸ—¿ğŸªğŸ­ğŸ“ğŸš©ğŸ‡¯ğŸ‡µğŸ‡°ğŸ‡·ğŸ‡©ğŸ‡ªğŸ‡¨ğŸ‡³ğŸ‡ºğŸ‡¸ğŸ‡«ğŸ‡·ğŸ‡ªğŸ‡¸ğŸ‡®ğŸ‡¹ğŸ‡·ğŸ‡ºğŸ‡¬ğŸ‡§",
        "symbols" : "1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£0ï¸âƒ£ğŸ”ŸğŸ”¢ğŸ”£â¬†â¬‡â¬…â¡ğŸ” ğŸ”¡ğŸ”¤â†—ï¸â†–ï¸â†˜ï¸â†™ï¸â†”ï¸â†•ï¸ğŸ”„â—€â–¶ğŸ”¼ğŸ”½â†©â†ªâ„¹âªâ©â«â¬â¤µâ¤´ğŸ†—ğŸ”€ğŸ”ğŸ”‚ğŸ†•ğŸ†™ğŸ†’ğŸ†“ğŸ†–ğŸ“¶ğŸ¦ğŸˆğŸˆ¯ğŸˆ³ğŸˆµğŸˆ´ğŸˆ²ğŸ‰ğŸˆ¹ğŸˆºğŸˆ¶ğŸˆšğŸš»ğŸš¹ğŸšºğŸš¼ğŸš¾ğŸš°ğŸš®ğŸ…¿â™¿ğŸš­ğŸˆ·ğŸˆ¸ğŸˆ‚â“‚ğŸ›‚ğŸ›„ğŸ›…ğŸ›ƒğŸ‰‘ãŠ™ãŠ—ğŸ†‘ğŸ†˜ğŸ†”ğŸš«ğŸ”ğŸ“µğŸš¯ğŸš±ğŸš³ğŸš·ğŸš¸â›”âœ³â‡ââœ…âœ´ğŸ’ŸğŸ†šğŸ“³ğŸ“´ğŸ…°ğŸ…±ğŸ†ğŸ…¾ğŸ’ â¿â™»â™ˆâ™‰â™Šâ™‹â™Œâ™â™â™â™â™‘â™’â™“â›ğŸ”¯ğŸ§ğŸ’¹ğŸ’²ğŸ’±Â©Â®â„¢âŒâ€¼â‰â—â“â•â”â­•ğŸ”ğŸ”šğŸ”™ğŸ”›ğŸ”œğŸ”ƒğŸ•›ğŸ•§ğŸ•ğŸ•œğŸ•‘ğŸ•ğŸ•’ğŸ•ğŸ•“ğŸ•ŸğŸ•”ğŸ• ğŸ••ğŸ•¡ğŸ•–ğŸ•¢ğŸ•—ğŸ•£ğŸ•˜ğŸ•¤ğŸ•™ğŸ•¥ğŸ•šğŸ•¦âœ–ï¸â•â–â—â™ ï¸â™¥ï¸â™£ï¸â™¦ï¸ğŸ’®ğŸ’¯âœ”ï¸â˜‘ï¸ğŸ”˜ğŸ”—â°ã€°ã€½ï¸ğŸ”±â—¼ï¸â—»ï¸â—¾ï¸â—½ï¸â–ªï¸â–«ï¸ğŸ”ºğŸ”²ğŸ”³âš«ï¸âšªï¸ğŸ”´ğŸ”µğŸ”»â¬œï¸â¬›ï¸ğŸ”¶ğŸ”·ğŸ”¸ğŸ”¹"
      ]
    }
    return Static.dic[group]!
  }
}
